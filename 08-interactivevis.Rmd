# Interactive visualisation

## Interactivity with [`ggvis`](http://ggvis.rstudio.com/)

> This section is based on the on-line [`ggvis` documentation](http://ggvis.rstudio.com/)

The goal of ggvis is to make it easy to build interactive graphics for
exploratory data analysis. `ggvis` has a similar underlying theory to
`ggplot2` (the grammar of graphics), but it's expressed a little
differently, and adds new features to make your plots
interactive. `ggvis` also incorporates shiny's reactive programming
model and `dplyr`'s grammar of data transformation.

```{r, eval = FALSE}
library("ggvis")
sml <- sample(nrow(surveys), 1e3)
surveys_sml <- surveys_complete[sml, ]

```

```{r, eval = FALSE}
p <- ggvis(surveys_sml, x = ~weight, y = ~hindfoot_length)
p %>% layer_points()
```

```{r, eval = FALSE}
surveys_sml %>%
    ggvis(x = ~weight, y = ~hindfoot_length,
          fill = ~species_id) %>%
    layer_points()
```

```{r, eval = FALSE}
p %>% layer_points(fill = ~species_id)
p %>% layer_points(shape = ~species_id)
```

To set fixed plotting parameters, use `:=`.

```{r, eval = FALSE}
p %>% layer_points(fill := "red", stroke := "black")
p %>% layer_points(size := 300, opacity := 0.4)
p %>% layer_points(shape := "cross")
```

### Interactivity

```{r, eval = FALSE}
p %>% layer_points(
          size := input_slider(10, 100),
          opacity := input_slider(0, 1))
```

```{r, eval = FALSE}
p %>%
    layer_points() %>% 
    add_tooltip(function(df) df$weight)
```

* `input_slider()`
* `input_checkbox()`
* `input_checkboxgroup()`
* `input_numeric()`
* `input_radiobuttons()`
* `input_select()`
* `input_text()`

See the
[interactivity vignette](http://ggvis.rstudio.com/interactivity.html)
for details.


### Layers

**Simple layers** 

* `layer_points()`, with properties x, y, shape, stroke, fill,
  strokeOpacity, fillOpacity, and opacity.
* `layer_paths()`, for paths and polygons (using the fill argument).
* `layer_ribbons()` for filled areas.
* `layer_rects()`, `layer_text()`.

**Compound layers**, which which combine data transformations with one
or more simple layers.

* `layer_lines()` which automatically orders by the x variable with
  `arrange()`.
* `layer_histograms()` and `layer_freqpolys()`, which first bin the
  data with `compute_bin()`.
* `layer_smooths()`, which fits and plots a smooth model to the data
  using `compute_smooth()`.

See the [layers vignette](http://ggvis.rstudio.com/layers.html) for
details.


Like for `ggplot2`'s geoms, we can overly multiple layers:


```{r, eval = FALSE}
p %>%
    layer_points() %>%
    layer_smooths(stroke := "red")
```

### More components 

* `scales`, to control the mapping between data and visual properties;
  see the
  [properties and scales vignette](http://ggvis.rstudio.com/properties-scales.html).

* `legends` and `axes` to control the appearance of the guides
  produced by the scales. See the
  [axes and legends vignette](http://ggvis.rstudio.com/axes-legends.html).

## Interactive apps with [`shiny`](https://shiny.rstudio.com/)

From the main [*shiny* page](https://shiny.rstudio.com/):

> Shiny is an R package that makes it easy to build interactive web
> apps straight from R.

When using `shiny`, one tends to aim for more complete, long-lasting
applications, rather then *simply* and transient visualisations.

A `shiny` application is composed of a *ui* (user interface) and a
server that exchange information using a programming paradigm called
*reactive programming*: changes performed by the user to the *ui*
trigger a reaction by the *server* and the output is updated
accordingly.

Before looking at the details of such an architecture, let's build a
simple example from scratch. This app, shown below, uses the
`faithful` data, describing the wainting time between eruptions and
the duration of the reuption for the Old Faithful geyser in
Yellowstone National Park, Wyoming, USA. 

```{r faithfuldata}
head(faithful)
```

It shows the distribution of waiting times along a histogram (produced by the )

```{r shinyapp1, echo=FALSE}
knitr::include_app("https://lgatto.shinyapps.io/shiny-app1/")
```


