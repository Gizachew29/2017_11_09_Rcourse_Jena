<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data analysis and R programming</title>
  <meta name="description" content="Material for the ‘Data analysis and R programming’ course.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Data analysis and R programming" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Material for the ‘Data analysis and R programming’ course." />
  <meta name="github-repo" content="lgatto/2017_11_09_Rcourse_Jena" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data analysis and R programming" />
  
  <meta name="twitter:description" content="Material for the ‘Data analysis and R programming’ course." />
  

<meta name="author" content="Laurent Gatto">


<meta name="date" content="2017-11-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="navigating-the-bioconductor-project.html">
<link rel="next" href="session-information.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#programme"><i class="fa fa-check"></i><b>1.2</b> Programme</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#license-and-credits"><i class="fa fa-check"></i><b>1.3</b> License and credits</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>2</b> Tidy data</a><ul>
<li class="chapter" data-level="2.1" data-path="tidy-data.html"><a href="tidy-data.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="tidy-data.html"><a href="tidy-data.html#tidy-data-1"><i class="fa fa-check"></i><b>2.2</b> Tidy data</a></li>
<li class="chapter" data-level="2.3" data-path="tidy-data.html"><a href="tidy-data.html#common-spreadsheet-errors"><i class="fa fa-check"></i><b>2.3</b> Common Spreadsheet Errors</a></li>
<li class="chapter" data-level="2.4" data-path="tidy-data.html"><a href="tidy-data.html#key-points"><i class="fa fa-check"></i><b>2.4</b> Key points</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="before-we-start.html"><a href="before-we-start.html"><i class="fa fa-check"></i><b>3</b> Before we start</a><ul>
<li class="chapter" data-level="3.1" data-path="before-we-start.html"><a href="before-we-start.html#what-is-r-what-is-rstudio"><i class="fa fa-check"></i><b>3.1</b> What is R? What is RStudio?</a></li>
<li class="chapter" data-level="3.2" data-path="before-we-start.html"><a href="before-we-start.html#why-learn-r"><i class="fa fa-check"></i><b>3.2</b> Why learn R?</a><ul>
<li class="chapter" data-level="3.2.1" data-path="before-we-start.html"><a href="before-we-start.html#r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing"><i class="fa fa-check"></i><b>3.2.1</b> R does not involve lots of pointing and clicking, and that’s a good thing</a></li>
<li class="chapter" data-level="3.2.2" data-path="before-we-start.html"><a href="before-we-start.html#r-code-is-great-for-reproducibility"><i class="fa fa-check"></i><b>3.2.2</b> R code is great for reproducibility</a></li>
<li class="chapter" data-level="3.2.3" data-path="before-we-start.html"><a href="before-we-start.html#r-is-interdisciplinary-and-extensible"><i class="fa fa-check"></i><b>3.2.3</b> R is interdisciplinary and extensible</a></li>
<li class="chapter" data-level="3.2.4" data-path="before-we-start.html"><a href="before-we-start.html#r-works-on-data-of-all-shapes-and-sizes"><i class="fa fa-check"></i><b>3.2.4</b> R works on data of all shapes and sizes</a></li>
<li class="chapter" data-level="3.2.5" data-path="before-we-start.html"><a href="before-we-start.html#r-produces-high-quality-graphics"><i class="fa fa-check"></i><b>3.2.5</b> R produces high-quality graphics</a></li>
<li class="chapter" data-level="3.2.6" data-path="before-we-start.html"><a href="before-we-start.html#r-has-a-large-and-welcoming-community"><i class="fa fa-check"></i><b>3.2.6</b> R has a large and welcoming community</a></li>
<li class="chapter" data-level="3.2.7" data-path="before-we-start.html"><a href="before-we-start.html#not-only-is-r-free-but-it-is-also-open-source-and-cross-platform"><i class="fa fa-check"></i><b>3.2.7</b> Not only is R free, but it is also open-source and cross-platform</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="before-we-start.html"><a href="before-we-start.html#knowing-your-way-around-rstudio"><i class="fa fa-check"></i><b>3.3</b> Knowing your way around RStudio</a></li>
<li class="chapter" data-level="3.4" data-path="before-we-start.html"><a href="before-we-start.html#getting-set-up"><i class="fa fa-check"></i><b>3.4</b> Getting set up</a><ul>
<li class="chapter" data-level="3.4.1" data-path="before-we-start.html"><a href="before-we-start.html#organizing-your-working-directory"><i class="fa fa-check"></i><b>3.4.1</b> Organizing your working directory</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="before-we-start.html"><a href="before-we-start.html#interacting-with-r"><i class="fa fa-check"></i><b>3.5</b> Interacting with R</a></li>
<li class="chapter" data-level="3.6" data-path="before-we-start.html"><a href="before-we-start.html#how-to-learn-more-after-the-workshop"><i class="fa fa-check"></i><b>3.6</b> How to learn more after the workshop?</a></li>
<li class="chapter" data-level="3.7" data-path="before-we-start.html"><a href="before-we-start.html#seeking-help"><i class="fa fa-check"></i><b>3.7</b> Seeking help</a><ul>
<li class="chapter" data-level="3.7.1" data-path="before-we-start.html"><a href="before-we-start.html#use-the-built-in-rstudio-help-interface-to-search-for-more-information-on-r-functions"><i class="fa fa-check"></i><b>3.7.1</b> Use the built-in RStudio help interface to search for more information on R functions</a></li>
<li class="chapter" data-level="3.7.2" data-path="before-we-start.html"><a href="before-we-start.html#i-know-the-name-of-the-function-i-want-to-use-but-im-not-sure-how-to-use-it"><i class="fa fa-check"></i><b>3.7.2</b> I know the name of the function I want to use, but I’m not sure how to use it</a></li>
<li class="chapter" data-level="3.7.3" data-path="before-we-start.html"><a href="before-we-start.html#i-want-to-use-a-function-that-does-x-there-must-be-a-function-for-it-but-i-dont-know-which-one"><i class="fa fa-check"></i><b>3.7.3</b> I want to use a function that does X, there must be a function for it but I don’t know which one…</a></li>
<li class="chapter" data-level="3.7.4" data-path="before-we-start.html"><a href="before-we-start.html#i-am-stuck-i-get-an-error-message-that-i-dont-understand"><i class="fa fa-check"></i><b>3.7.4</b> I am stuck… I get an error message that I don’t understand</a></li>
<li class="chapter" data-level="3.7.5" data-path="before-we-start.html"><a href="before-we-start.html#asking-for-help"><i class="fa fa-check"></i><b>3.7.5</b> Asking for help</a></li>
<li class="chapter" data-level="3.7.6" data-path="before-we-start.html"><a href="before-we-start.html#where-to-ask-for-help"><i class="fa fa-check"></i><b>3.7.6</b> Where to ask for help?</a></li>
<li class="chapter" data-level="3.7.7" data-path="before-we-start.html"><a href="before-we-start.html#more-resources"><i class="fa fa-check"></i><b>3.7.7</b> More resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>4</b> Introduction to R</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#creating-objects-in-r"><i class="fa fa-check"></i><b>4.1</b> Creating objects in R</a><ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#comments"><i class="fa fa-check"></i><b>4.1.1</b> Comments</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions-and-their-arguments"><i class="fa fa-check"></i><b>4.1.2</b> Functions and their arguments</a></li>
<li class="chapter" data-level="4.1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#objects-vs.variables"><i class="fa fa-check"></i><b>4.1.3</b> Objects vs. variables</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors-and-data-types"><i class="fa fa-check"></i><b>4.2</b> Vectors and data types</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#subsetting-vectors"><i class="fa fa-check"></i><b>4.3</b> Subsetting vectors</a><ul>
<li class="chapter" data-level="4.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#conditional-subsetting"><i class="fa fa-check"></i><b>4.3.1</b> Conditional subsetting</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#missing-data"><i class="fa fa-check"></i><b>4.4</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="starting-with-data.html"><a href="starting-with-data.html"><i class="fa fa-check"></i><b>5</b> Starting with data</a><ul>
<li class="chapter" data-level="5.1" data-path="starting-with-data.html"><a href="starting-with-data.html#presentation-of-the-survey-data"><i class="fa fa-check"></i><b>5.1</b> Presentation of the Survey Data</a></li>
<li class="chapter" data-level="5.2" data-path="starting-with-data.html"><a href="starting-with-data.html#what-are-data-frames"><i class="fa fa-check"></i><b>5.2</b> What are data frames?</a></li>
<li class="chapter" data-level="5.3" data-path="starting-with-data.html"><a href="starting-with-data.html#inspecting-data.frame-objects"><i class="fa fa-check"></i><b>5.3</b> Inspecting <code>data.frame</code> Objects</a></li>
<li class="chapter" data-level="5.4" data-path="starting-with-data.html"><a href="starting-with-data.html#indexing-and-subsetting-data-frames"><i class="fa fa-check"></i><b>5.4</b> Indexing and subsetting data frames</a></li>
<li class="chapter" data-level="5.5" data-path="starting-with-data.html"><a href="starting-with-data.html#factors"><i class="fa fa-check"></i><b>5.5</b> Factors</a></li>
<li class="chapter" data-level="5.6" data-path="starting-with-data.html"><a href="starting-with-data.html#formatting-dates"><i class="fa fa-check"></i><b>5.6</b> Formatting Dates</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manipulating-and-analyzing-data.html"><a href="manipulating-and-analyzing-data.html"><i class="fa fa-check"></i><b>6</b> Manipulating and analyzing data</a><ul>
<li class="chapter" data-level="6.1" data-path="manipulating-and-analyzing-data.html"><a href="manipulating-and-analyzing-data.html#what-are-dplyr-and-tidyr"><i class="fa fa-check"></i><b>6.1</b> What are <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong>?</a></li>
<li class="chapter" data-level="6.2" data-path="manipulating-and-analyzing-data.html"><a href="manipulating-and-analyzing-data.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>6.2</b> Selecting columns and filtering rows</a></li>
<li class="chapter" data-level="6.3" data-path="manipulating-and-analyzing-data.html"><a href="manipulating-and-analyzing-data.html#pipes"><i class="fa fa-check"></i><b>6.3</b> Pipes</a></li>
<li class="chapter" data-level="6.4" data-path="manipulating-and-analyzing-data.html"><a href="manipulating-and-analyzing-data.html#mutate"><i class="fa fa-check"></i><b>6.4</b> Mutate</a></li>
<li class="chapter" data-level="6.5" data-path="manipulating-and-analyzing-data.html"><a href="manipulating-and-analyzing-data.html#split-apply-combine-data-analysis-and-the-summarize-function"><i class="fa fa-check"></i><b>6.5</b> Split-apply-combine data analysis and the summarize() function</a><ul>
<li class="chapter" data-level="6.5.1" data-path="manipulating-and-analyzing-data.html"><a href="manipulating-and-analyzing-data.html#the-summarize-function"><i class="fa fa-check"></i><b>6.5.1</b> The <code>summarize()</code> function</a></li>
<li class="chapter" data-level="6.5.2" data-path="manipulating-and-analyzing-data.html"><a href="manipulating-and-analyzing-data.html#tallying"><i class="fa fa-check"></i><b>6.5.2</b> Tallying</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="manipulating-and-analyzing-data.html"><a href="manipulating-and-analyzing-data.html#reshaping-with-gather-and-spread"><i class="fa fa-check"></i><b>6.6</b> Reshaping with gather and spread</a></li>
<li class="chapter" data-level="6.7" data-path="manipulating-and-analyzing-data.html"><a href="manipulating-and-analyzing-data.html#exporting-data"><i class="fa fa-check"></i><b>6.7</b> Exporting data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Data visualization with ggplot2</a><ul>
<li class="chapter" data-level="7.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>7.1</b> Plotting with <strong><code>ggplot2</code></strong></a></li>
<li class="chapter" data-level="7.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#building-your-plots-iteratively"><i class="fa fa-check"></i><b>7.2</b> Building your plots iteratively</a></li>
<li class="chapter" data-level="7.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#boxplot"><i class="fa fa-check"></i><b>7.3</b> Boxplot</a></li>
<li class="chapter" data-level="7.4" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#plotting-time-series-data"><i class="fa fa-check"></i><b>7.4</b> Plotting time series data</a></li>
<li class="chapter" data-level="7.5" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#faceting"><i class="fa fa-check"></i><b>7.5</b> Faceting</a></li>
<li class="chapter" data-level="7.6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#ggplot2-themes"><i class="fa fa-check"></i><b>7.6</b> <strong><code>ggplot2</code></strong> themes</a></li>
<li class="chapter" data-level="7.7" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#customization"><i class="fa fa-check"></i><b>7.7</b> Customization</a></li>
<li class="chapter" data-level="7.8" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#arranging-and-exporting-plots"><i class="fa fa-check"></i><b>7.8</b> Arranging and exporting plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reproducible-research-with-rmarkdown.html"><a href="reproducible-research-with-rmarkdown.html"><i class="fa fa-check"></i><b>8</b> Reproducible research with Rmarkdown</a><ul>
<li class="chapter" data-level="8.1" data-path="reproducible-research-with-rmarkdown.html"><a href="reproducible-research-with-rmarkdown.html#introduction-2"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="reproducible-research-with-rmarkdown.html"><a href="reproducible-research-with-rmarkdown.html#additional-features"><i class="fa fa-check"></i><b>8.2</b> Additional features</a></li>
<li class="chapter" data-level="8.3" data-path="reproducible-research-with-rmarkdown.html"><a href="reproducible-research-with-rmarkdown.html#challenge-1"><i class="fa fa-check"></i><b>8.3</b> Challenge</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="r-package-development.html"><a href="r-package-development.html"><i class="fa fa-check"></i><b>9</b> R Package Development</a><ul>
<li class="chapter" data-level="9.1" data-path="r-package-development.html"><a href="r-package-development.html#introduction-3"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="9.1.1" data-path="r-package-development.html"><a href="r-package-development.html#references"><i class="fa fa-check"></i><b>9.1.1</b> References</a></li>
<li class="chapter" data-level="9.1.2" data-path="r-package-development.html"><a href="r-package-development.html#terminology"><i class="fa fa-check"></i><b>9.1.2</b> Terminology</a></li>
<li class="chapter" data-level="9.1.3" data-path="r-package-development.html"><a href="r-package-development.html#requirement"><i class="fa fa-check"></i><b>9.1.3</b> Requirement</a></li>
<li class="chapter" data-level="9.1.4" data-path="r-package-development.html"><a href="r-package-development.html#course-content"><i class="fa fa-check"></i><b>9.1.4</b> Course content</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="r-package-development.html"><a href="r-package-development.html#preparing-r-code"><i class="fa fa-check"></i><b>9.2</b> Preparing R code</a></li>
<li class="chapter" data-level="9.3" data-path="r-package-development.html"><a href="r-package-development.html#package-layout"><i class="fa fa-check"></i><b>9.3</b> Package layout</a></li>
<li class="chapter" data-level="9.4" data-path="r-package-development.html"><a href="r-package-development.html#package-developement-cycle"><i class="fa fa-check"></i><b>9.4</b> Package developement cycle</a></li>
<li class="chapter" data-level="9.5" data-path="r-package-development.html"><a href="r-package-development.html#package-metadata"><i class="fa fa-check"></i><b>9.5</b> Package metadata</a></li>
<li class="chapter" data-level="9.6" data-path="r-package-development.html"><a href="r-package-development.html#namespace"><i class="fa fa-check"></i><b>9.6</b> <code>NAMESPACE</code></a></li>
<li class="chapter" data-level="9.7" data-path="r-package-development.html"><a href="r-package-development.html#r-code"><i class="fa fa-check"></i><b>9.7</b> R code</a></li>
<li class="chapter" data-level="9.8" data-path="r-package-development.html"><a href="r-package-development.html#package-sub-directories"><i class="fa fa-check"></i><b>9.8</b> Package sub-directories</a></li>
<li class="chapter" data-level="9.9" data-path="r-package-development.html"><a href="r-package-development.html#documentation"><i class="fa fa-check"></i><b>9.9</b> Documentation</a><ul>
<li class="chapter" data-level="9.9.1" data-path="r-package-development.html"><a href="r-package-development.html#manual-pages"><i class="fa fa-check"></i><b>9.9.1</b> Manual pages</a></li>
<li class="chapter" data-level="9.9.2" data-path="r-package-development.html"><a href="r-package-development.html#using-roxygen"><i class="fa fa-check"></i><b>9.9.2</b> Using roxygen</a></li>
<li class="chapter" data-level="9.9.3" data-path="r-package-development.html"><a href="r-package-development.html#vignettes"><i class="fa fa-check"></i><b>9.9.3</b> Vignettes</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="r-package-development.html"><a href="r-package-development.html#additional-files"><i class="fa fa-check"></i><b>9.10</b> Additional files</a></li>
<li class="chapter" data-level="9.11" data-path="r-package-development.html"><a href="r-package-development.html#distributing-packages"><i class="fa fa-check"></i><b>9.11</b> Distributing packages</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html"><i class="fa fa-check"></i><b>10</b> Visualisation of high-dimensional data in R</a><ul>
<li class="chapter" data-level="10.1" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#introduction-4"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#data"><i class="fa fa-check"></i><b>10.2</b> Data</a></li>
<li class="chapter" data-level="10.3" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#k-means-clustering"><i class="fa fa-check"></i><b>10.3</b> K-means clustering</a><ul>
<li class="chapter" data-level="10.3.1" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#how-does-k-means-work"><i class="fa fa-check"></i><b>10.3.1</b> How does k-means work</a></li>
<li class="chapter" data-level="10.3.2" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#model-selection"><i class="fa fa-check"></i><b>10.3.2</b> Model selection</a></li>
<li class="chapter" data-level="10.3.3" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#how-to-determine-the-number-of-clusters"><i class="fa fa-check"></i><b>10.3.3</b> How to determine the number of clusters</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#hierarchical-clustering"><i class="fa fa-check"></i><b>10.4</b> Hierarchical clustering</a><ul>
<li class="chapter" data-level="10.4.1" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#how-does-hierarchical-clustering-work"><i class="fa fa-check"></i><b>10.4.1</b> How does hierarchical clustering work</a></li>
<li class="chapter" data-level="10.4.2" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#defining-clusters"><i class="fa fa-check"></i><b>10.4.2</b> Defining clusters</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>10.5</b> Principal component analysis (PCA)</a><ul>
<li class="chapter" data-level="10.5.1" data-path="visualisation-of-high-dimensional-data-in-r.html"><a href="visualisation-of-high-dimensional-data-in-r.html#visualisation"><i class="fa fa-check"></i><b>10.5.1</b> Visualisation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html"><i class="fa fa-check"></i><b>11</b> Interactive visualisation</a><ul>
<li class="chapter" data-level="11.1" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#interactivity-graphs"><i class="fa fa-check"></i><b>11.1</b> Interactivity graphs</a><ul>
<li class="chapter" data-level="11.1.1" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#interactivity"><i class="fa fa-check"></i><b>11.1.1</b> Interactivity</a></li>
<li class="chapter" data-level="11.1.2" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#layers"><i class="fa fa-check"></i><b>11.1.2</b> Layers</a></li>
<li class="chapter" data-level="11.1.3" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#more-components"><i class="fa fa-check"></i><b>11.1.3</b> More components</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#interactive-apps"><i class="fa fa-check"></i><b>11.2</b> Interactive apps</a><ul>
<li class="chapter" data-level="11.2.1" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#introduction-5"><i class="fa fa-check"></i><b>11.2.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2.2" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#creation-of-our-fist-shiny-app"><i class="fa fa-check"></i><b>11.2.2</b> Creation of our fist shiny app</a></li>
<li class="chapter" data-level="11.2.3" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#the-shiny-infrastructure"><i class="fa fa-check"></i><b>11.2.3</b> The shiny infrastructure</a></li>
<li class="chapter" data-level="11.2.4" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#another-shiny-app"><i class="fa fa-check"></i><b>11.2.4</b> Another shiny app</a></li>
<li class="chapter" data-level="11.2.5" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#single-file-app"><i class="fa fa-check"></i><b>11.2.5</b> Single-file app</a></li>
<li class="chapter" data-level="11.2.6" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html#theres-more-to-shiny"><i class="fa fa-check"></i><b>11.2.6</b> There’s more to <code>shiny</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html"><i class="fa fa-check"></i><b>12</b> Navigating the Bioconductor project</a><ul>
<li class="chapter" data-level="12.1" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html#biocviews"><i class="fa fa-check"></i><b>12.1</b> <em>biocViews</em></a></li>
<li class="chapter" data-level="12.2" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html#workflows"><i class="fa fa-check"></i><b>12.2</b> Workflows</a></li>
<li class="chapter" data-level="12.3" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html#learning-about-specific-packages"><i class="fa fa-check"></i><b>12.3</b> Learning about specific packages</a><ul>
<li class="chapter" data-level="12.3.1" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html#package-vignettes"><i class="fa fa-check"></i><b>12.3.1</b> Package vignettes</a></li>
<li class="chapter" data-level="12.3.2" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html#installation-1"><i class="fa fa-check"></i><b>12.3.2</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html#versions"><i class="fa fa-check"></i><b>12.4</b> Versions</a></li>
<li class="chapter" data-level="12.5" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html#getting-help"><i class="fa fa-check"></i><b>12.5</b> Getting help</a></li>
<li class="chapter" data-level="12.6" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html#data-infrastructure"><i class="fa fa-check"></i><b>12.6</b> Data infrastructure</a></li>
<li class="chapter" data-level="12.7" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html#more-resources-1"><i class="fa fa-check"></i><b>12.7</b> More resources</a></li>
<li class="chapter" data-level="12.8" data-path="navigating-the-bioconductor-project.html"><a href="navigating-the-bioconductor-project.html#challenges"><i class="fa fa-check"></i><b>12.8</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html"><i class="fa fa-check"></i><b>13</b> R programming concepts and tools</a><ul>
<li class="chapter" data-level="13.1" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#defensive-programming"><i class="fa fa-check"></i><b>13.1</b> Defensive programming</a><ul>
<li class="chapter" data-level="" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#talking-to-users"><i class="fa fa-check"></i>Talking to users</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#kiss"><i class="fa fa-check"></i><b>13.2</b> KISS</a></li>
<li class="chapter" data-level="13.3" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#failing-fast-and-well"><i class="fa fa-check"></i><b>13.3</b> Failing fast and well</a></li>
<li class="chapter" data-level="13.4" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#consistency-and-predictability"><i class="fa fa-check"></i><b>13.4</b> Consistency and predictability</a></li>
<li class="chapter" data-level="13.5" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#comparisons"><i class="fa fa-check"></i><b>13.5</b> Comparisons</a><ul>
<li class="chapter" data-level="" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#floating-point-issues-to-be-aware-of"><i class="fa fa-check"></i>Floating point issues to be aware of</a></li>
<li class="chapter" data-level="" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#floating-point-how-to-compare"><i class="fa fa-check"></i>Floating point: how to compare</a></li>
<li class="chapter" data-level="" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#exact-identity"><i class="fa fa-check"></i>Exact identity</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#exercise"><i class="fa fa-check"></i><b>13.6</b> Exercise</a></li>
<li class="chapter" data-level="13.7" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#debugging-techniques-and-tools"><i class="fa fa-check"></i><b>13.7</b> Debugging: techniques and tools</a><ul>
<li class="chapter" data-level="" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#tools"><i class="fa fa-check"></i>Tools</a></li>
<li class="chapter" data-level="" data-path="r-programming-concepts-and-tools.html"><a href="r-programming-concepts-and-tools.html#exercise-1"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-information.html"><a href="session-information.html"><i class="fa fa-check"></i>Session information</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data analysis and R programming</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-programming-concepts-and-tools" class="section level1">
<h1><span class="header-section-number">Chapter 13</span> R programming concepts and tools</h1>
<blockquote>
<p>This section is composed of various section of more advanced programming topics from the <a href="https://lgatto.github.io/TeachingMaterial/">Teaching Material</a> page.</p>
</blockquote>
<div id="defensive-programming" class="section level2">
<h2><span class="header-section-number">13.1</span> Defensive programming</h2>
<p>Before even debugging, let’s look at ways to prevent bugs in the first place.</p>
<p><strong>Defensive programming:</strong></p>
<ul>
<li>making the code work in a predicable manner</li>
<li>writing code that fails in a well-defined manner</li>
<li>if something <em>weird</em> happens, either properly deal with it, of fail quickly and loudly</li>
</ul>
<p>The level of defensiveness will depend whether you write a function for interactive of programmatic usage.</p>
<div id="talking-to-users" class="section level3 unnumbered">
<h3>Talking to users</h3>
<div id="diagnostic-messages" class="section level4 unnumbered">
<h4>Diagnostic messages</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">message</span>(<span class="st">&quot;This is a message for our dear users.&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">message</span>(<span class="st">&quot;This is a message for our dear users. &quot;</span>,
    <span class="kw">paste</span>(<span class="st">&quot;Thank you for using our software&quot;</span>,
              sw, <span class="st">&quot;version&quot;</span>, <span class="kw">packageVersion</span>(sw)))</code></pre></div>
<p>Do not use <code>print</code> or <code>cat</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f1 &lt;-<span class="st"> </span><span class="cf">function</span>() {
    <span class="kw">cat</span>(<span class="st">&quot;I AM LOUD AND YOU CAN&#39;T HELP IT.</span><span class="ch">\n</span><span class="st">&quot;</span>)
    ## do stuff
    <span class="kw">invisible</span>(<span class="ot">TRUE</span>)
}
<span class="kw">f1</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f2 &lt;-<span class="st"> </span><span class="cf">function</span>() {
    <span class="kw">message</span>(<span class="st">&quot;Sorry to interup, but...&quot;</span>)
    ## do stuff
    <span class="kw">invisible</span>(<span class="ot">TRUE</span>)
}
<span class="kw">f2</span>()
<span class="kw">suppressMessages</span>(<span class="kw">f2</span>())</code></pre></div>
<p>Of course, it is also possible to manually define verbosity. This makes you write more code for a feature readily available. But still better to use <code>message</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f3 &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">TRUE</span>) {
    <span class="cf">if</span> (verbose)
        <span class="kw">message</span>(<span class="st">&quot;I am being verbose because you let me.&quot;</span>)
    ## do stuff
    <span class="kw">invisible</span>(<span class="ot">TRUE</span>)
}
<span class="kw">f3</span>()
<span class="kw">f3</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
<div id="warning" class="section level4 unnumbered">
<h4>Warning</h4>
<blockquote>
<p>There is a problem with warnings. No one reads them. Pat Burns, in <em>R inferno</em>.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">warning</span>(<span class="st">&quot;Do not ignore me. Somthing bad might have happened.&quot;</span>)
<span class="kw">warning</span>(<span class="st">&quot;Do not ignore me. Somthing bad might be happening.&quot;</span>, <span class="dt">immediate. =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="cf">function</span>(...)
    <span class="kw">warning</span>(<span class="st">&quot;Attention, attention, ...!&quot;</span>, ...)
<span class="kw">f</span>()
<span class="kw">f</span>(<span class="dt">call. =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Print warnings after they have been thrown.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">warnings</span>()
last.warning</code></pre></div>
<p>See also to <code>warn</code> option in <code>?options</code> .</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">option</span>(<span class="st">&quot;warn&quot;</span>)</code></pre></div>
</div>
<div id="error" class="section level4 unnumbered">
<h4>Error</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stop</span>(<span class="st">&quot;This is the end, my friend.&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">log</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>)); <span class="kw">print</span>(<span class="st">&#39;end&#39;</span>) ## warning 
<span class="kw">xor</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>));  <span class="kw">print</span> (<span class="st">&#39;end&#39;</span>)  ## error</code></pre></div>
<p>Stop also has a <code>call.</code> parameter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">geterrmessage</span>()</code></pre></div>
</div>
<div id="progress-bars" class="section level4 unnumbered">
<h4>Progress bars</h4>
<ul>
<li><code>utils::txtProgressBar</code> function</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">10</span>
pb &lt;-<span class="st"> </span><span class="kw">txtProgressBar</span>(<span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> n, <span class="dt">style =</span> <span class="dv">3</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
    <span class="kw">setTxtProgressBar</span>(pb, i)
    <span class="kw">Sys.sleep</span>(<span class="fl">0.5</span>)
}
<span class="kw">close</span>(pb)</code></pre></div>
<ul>
<li><a href="https://github.com/gaborcsardi/progress"><code>progress</code></a> package</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;progress&quot;</span>)
pb &lt;-<span class="st"> </span>progress_bar<span class="op">$</span><span class="kw">new</span>(<span class="dt">total =</span> n)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
    pb<span class="op">$</span><span class="kw">tick</span>()
    <span class="kw">Sys.sleep</span>(<span class="fl">0.5</span>)
}</code></pre></div>
<p>Tip: do not over use progress bars. Ideally, a user should be confident that everything is under control and progress is made while waiting for a function to return. In my experience, a progress bar is usefull when there is a specific and/or user-defined number of iterations, such a <em>iterating over n files</em>, or <em>running a simulation n times</em>.</p>
</div>
</div>
</div>
<div id="kiss" class="section level2">
<h2><span class="header-section-number">13.2</span> KISS</h2>
<p>Keep your functions simple and stupid (and short).</p>
</div>
<div id="failing-fast-and-well" class="section level2">
<h2><span class="header-section-number">13.3</span> Failing fast and well</h2>
<blockquote>
<p>Bounds errors are ugly, nasty things that should be stamped out whenever possible. One solution to this problem is to use the <code>assert</code> statement. The <code>assert</code> statement tells C++, “This can never happen, but if it does, abort the program in a nice way.” One thing you find out as you gain programming experience is that things that can “never happen” happen with alarming frequency. So just to make sure that things work as they are supposed to, it’s a good idea to put lots of self checks in your program. – Practical C++ Programming, Steve Oualline, O’Reilly.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span>condition) <span class="kw">stop</span>(...)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stopifnot</span>(<span class="ot">TRUE</span>)
<span class="kw">stopifnot</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</code></pre></div>
<p>For example to test input classes, lengths, …</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
    <span class="kw">stopifnot</span>(<span class="kw">is.numeric</span>(x), <span class="kw">length</span>(x) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
    <span class="kw">invisible</span>(<span class="ot">TRUE</span>)
}

<span class="kw">f</span>(<span class="dv">1</span>)
<span class="kw">f</span>(<span class="st">&quot;1&quot;</span>)
<span class="kw">f</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)
<span class="kw">f</span>(letters)</code></pre></div>
<p>The <a href="https://github.com/hadley/assertthat"><code>assertthat</code></a> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> &quot;1&quot;</span>
<span class="kw">library</span>(<span class="st">&quot;assertthat&quot;</span>)
<span class="kw">stopifnot</span>(<span class="kw">is.numeric</span>(x))
<span class="kw">assert_that</span>(<span class="kw">is.numeric</span>(x))
<span class="kw">assert_that</span>(<span class="kw">length</span>(x) <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<ul>
<li><code>assert_that()</code> signal an error.</li>
<li><code>see_if()</code> returns a logical value, with the error message as an attribute.</li>
<li><p><code>validate_that()</code> returns <code>TRUE</code> on success, otherwise returns the error as a string.</p></li>
<li><code>is.flag(x)</code>: is x <code>TRUE</code> or <code>FALSE</code>? (a boolean flag)</li>
<li><code>is.string(x)</code>: is x a length 1 character vector?</li>
<li><code>has_name(x, nm)</code>, <code>x %has_name% nm</code>: does <code>x</code> have component <code>nm</code>?</li>
<li><code>has_attr(x, attr)</code>, <code>x %has_attr% attr</code>: does <code>x</code> have attribute <code>attr</code>?</li>
<li><code>is.count(x)</code>: is x a single positive integer?</li>
<li><code>are_equal(x, y)</code>: are <code>x</code> and <code>y</code> equal?</li>
<li><code>not_empty(x)</code>: are all dimensions of <code>x</code> greater than 0?</li>
<li><code>noNA(x)</code>: is <code>x</code> free from missing values?</li>
<li><code>is.dir(path)</code>: is <code>path</code> a directory?</li>
<li><code>is.writeable(path)</code>/<code>is.readable(path)</code>: is <code>path</code> writeable/readable?</li>
<li><p><code>has_extension(path, extension)</code>: does <code>file</code> have given <code>extension</code>?</p></li>
</ul>
</div>
<div id="consistency-and-predictability" class="section level2">
<h2><span class="header-section-number">13.4</span> Consistency and predictability</h2>
<p><strong>Ineractive use vs programming</strong>: Moving from using R to programming R is <em>abstraction</em>, <em>automation</em>, <em>generalisation</em>.</p>
<div id="drop" class="section level4 unnumbered">
<h4><code>drop</code></h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(cars)
<span class="kw">head</span>(cars[, <span class="dv">1</span>])
<span class="kw">head</span>(cars[, <span class="dv">1</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>])</code></pre></div>
</div>
<div id="sapplylapply" class="section level4 unnumbered">
<h4><code>sapply/lapply</code></h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])
<span class="kw">sapply</span>(df1, class)
df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> <span class="kw">Sys.time</span>() <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)
<span class="kw">sapply</span>(df2, class)</code></pre></div>
<p>Rather use a form where the return data structure is known…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(df1, class)
<span class="kw">lapply</span>(df2, class)</code></pre></div>
<p>or that will break if the result is not what is exected</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vapply</span>(df1, class, <span class="st">&quot;1&quot;</span>)
<span class="kw">vapply</span>(df2, class, <span class="st">&quot;1&quot;</span>)</code></pre></div>
<p>Reminder of the interactive use vs programming examples: - <code>[</code> and <code>drop</code> - <code>sapply</code>, <code>lapply</code>, <code>vapply</code></p>
<p>Remember also the concept of <em>tidy data</em>.</p>
</div>
</div>
<div id="comparisons" class="section level2">
<h2><span class="header-section-number">13.5</span> Comparisons</h2>
<div id="floating-point-issues-to-be-aware-of" class="section level3 unnumbered">
<h3>Floating point issues to be aware of</h3>
<p>R FAQ <a href="http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-doesn_0027t-R-think-these-numbers-are-equal_003f">7.31</a>?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>)
a <span class="op">*</span><span class="st"> </span>a <span class="op">==</span><span class="st"> </span><span class="dv">2</span>
a <span class="op">*</span><span class="st"> </span>a <span class="op">-</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">1L <span class="op">+</span><span class="st"> </span>2L <span class="op">==</span><span class="st"> </span>3L
<span class="fl">1.0</span> <span class="op">+</span><span class="st"> </span><span class="fl">2.0</span> <span class="op">==</span><span class="st"> </span><span class="fl">3.0</span>
<span class="fl">0.1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span> <span class="op">==</span><span class="st"> </span><span class="fl">0.3</span></code></pre></div>
</div>
<div id="floating-point-how-to-compare" class="section level3 unnumbered">
<h3>Floating point: how to compare</h3>
<ul>
<li><code>all.equal</code> compares R objects for <em>near equality</em>. Takes into account whether object attributes and names ought the taken into consideration (<code>check.attributes</code> and <code>check.names</code> parameters) and tolerance, which is machine dependent.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(<span class="fl">0.1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span>, <span class="fl">0.3</span>)
<span class="kw">all.equal</span>(<span class="fl">0.1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span>, <span class="fl">3.0</span>)
<span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="fl">0.1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span>, <span class="dv">3</span>)) ## when you just want TRUE/FALSE</code></pre></div>
</div>
<div id="exact-identity" class="section level3 unnumbered">
<h3>Exact identity</h3>
<p><code>identical</code>: test objects for exact equality</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">==</span><span class="st"> </span><span class="ot">NULL</span>
<span class="kw">all.equal</span>(<span class="dv">1</span>, <span class="ot">NULL</span>)
<span class="kw">identical</span>(<span class="dv">1</span>, <span class="ot">NULL</span>)
<span class="kw">identical</span>(<span class="dv">1</span>, <span class="dv">1</span>.)   ## TRUE in R (both are stored as doubles)
<span class="kw">all.equal</span>(<span class="dv">1</span>, 1L)
<span class="kw">identical</span>(<span class="dv">1</span>, 1L)   ## stored as different types</code></pre></div>
<p>Appropriate within <code>if</code>, <code>while</code> condition statements. (not <code>all.equal</code>, unless wrapped in <code>isTRUE</code>).</p>
</div>
</div>
<div id="exercise" class="section level2">
<h2><span class="header-section-number">13.6</span> Exercise</h2>
<p>From <a href="http://adv-r.had.co.nz/Exceptions-Debugging.html#defensive-programming">Advanced R</a> by Hadley Wickham.</p>
<p>The <code>col_means</code> function computes the means of all numeric columns in a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_means &lt;-<span class="st"> </span><span class="cf">function</span>(df) {
  numeric &lt;-<span class="st"> </span><span class="kw">sapply</span>(df, is.numeric)
  numeric_cols &lt;-<span class="st"> </span>df[, numeric]
  <span class="kw">data.frame</span>(<span class="kw">lapply</span>(numeric_cols, mean))
}</code></pre></div>
<p>Is it a robust function? What happens if there are unusual inputs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">col_means</span>(mtcars)
<span class="kw">col_means</span>(mtcars[, <span class="dv">0</span>])
<span class="kw">col_means</span>(mtcars[<span class="dv">0</span>, ])
<span class="kw">col_means</span>(mtcars[, <span class="st">&quot;mpg&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>])
<span class="kw">col_means</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)
<span class="kw">col_means</span>(<span class="kw">as.matrix</span>(mtcars))
<span class="kw">col_means</span>(<span class="kw">as.list</span>(mtcars))

mtcars2 &lt;-<span class="st"> </span>mtcars
mtcars2[<span class="op">-</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">lapply</span>(mtcars2[<span class="op">-</span><span class="dv">1</span>], as.character)
<span class="kw">col_means</span>(mtcars2)</code></pre></div>
<p>Using some of the concepts and tips above, re-write <code>col_means</code> to make it more robust.</p>
</div>
<div id="debugging-techniques-and-tools" class="section level2">
<h2><span class="header-section-number">13.7</span> Debugging: techniques and tools</h2>
<p><strong>Shit happens!</strong></p>
<blockquote>
<p>Funding your bug is a process of confirming the many things that you believe are true - until you find one which is not true. – Norm Matloff</p>
</blockquote>
<div id="identify-the-bug-the-difficult-part" class="section level4 unnumbered">
<h4>1. Identify the bug (the difficult part)</h4>
<ul>
<li>Something went wrong!</li>
<li>Where in the code does it happen?</li>
<li>Does it happen every time?</li>
<li>What input triggered it?</li>
<li>Report it (even if it is in your code - use github issues, for example).</li>
</ul>
<p><strong>Tip</strong>: Beware of your intuition. As a scientist, do what you are used to: generate a hypotheses, <em>design an experiment</em> to test them, and record the results.</p>
</div>
<div id="fix-it-the-less-difficult-part" class="section level4 unnumbered">
<h4>2. Fix it (the less difficult part)</h4>
<ul>
<li>Correct the bug.</li>
<li>Make sure that bug will not repeat itself!</li>
<li>How can we be confident that we haven’t introduced new bugs?</li>
</ul>
</div>
<div id="tools" class="section level3 unnumbered">
<h3>Tools</h3>
<ul>
<li><code>print</code>/<code>cat</code></li>
<li><code>traceback()</code></li>
<li><code>browser()</code></li>
<li>IDE: RStudio, StatET, emacs’ ess tracebug.</li>
</ul>
<div id="manually" class="section level4 unnumbered">
<h4>Manually</h4>
<p>Inserting <code>print</code> and <code>cat</code> statements in the code. Works, but time consuming.</p>
</div>
<div id="finding-the-bug" class="section level4 unnumbered">
<h4>Finding the bug</h4>
<p>Bugs are shy, and are generally hidden, deep down in your code, to make it as difficult as possible for you to find them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">e &lt;-<span class="st"> </span><span class="cf">function</span>(i) {
  x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>
  <span class="cf">if</span> (i <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>) x[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]
  <span class="cf">else</span> x[<span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]
}
f &lt;-<span class="st"> </span><span class="cf">function</span>() <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, e)
g &lt;-<span class="st"> </span><span class="cf">function</span>() <span class="kw">f</span>()</code></pre></div>
<p><code>traceback</code>: lists the sequence of calls that lead to the error</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">g</span>()
<span class="kw">traceback</span>()</code></pre></div>
<p>If the source code is available (for example for <code>source()</code>d code), then traceback will display the exact location in the function, in the form <code>filename.R#linenum</code>.</p>
</div>
<div id="browsing-the-error" class="section level4 unnumbered">
<h4>Browsing the error</h4>
<ul>
<li><p>Register the function for debugging: <code>debug(g)</code>. This adds a call to the <code>browser()</code> function (see also below) and the very beginning of the function <code>g</code>.</p></li>
<li><p>Every call to <code>g()</code> will not be run interactively.</p></li>
<li><p>To finish debugging: <code>undebug(g)</code>.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">debug</span>(g)
<span class="kw">g</span>()</code></pre></div>
<p>How to debug:</p>
<ul>
<li><code>n</code> executes the next step of the function. Use <code>print(n)</code> or <code>get(n)</code> to print/access the variable <code>n</code>.</li>
<li><code>s</code> to step into the next function. If it is not a function, same as <code>n</code>.</li>
<li><code>f</code> to finish execution of the current loop of function.</li>
<li><code>c</code> to leave interactive debugging and continue regular execution of the function.</li>
<li><code>Q</code> to stop debugging, terminate the function and return to the global workspace.</li>
<li><code>where</code> print a stack trace of all active function calls.</li>
<li><code>Enter</code> same as <code>n</code> (or <code>s</code>, if it was used most recently), unless <code>options(browserNLdisabled = TRUE)</code> is set.</li>
</ul>
<p>To fix a function when the source code is not directly available, use <code>fix(fun)</code>. This will open the function’s source code for editing and, after saving and closing, store the updated function in the global workspace.</p>
</div>
<div id="breakpoints" class="section level4 unnumbered">
<h4>Breakpoints</h4>
<ul>
<li><p>Add a call to <code>browser()</code> anywhere in the source code to execute the rest of the code interactively.</p></li>
<li><p>To run breakpoints conditionally, wrap the call to <code>browser()</code> in a condition.</p></li>
</ul>
</div>
<div id="debugging-with-ides" class="section level4 unnumbered">
<h4>Debugging with IDEs</h4>
<ul>
<li>RSudio: <code>Show Traceback</code>, <code>Rerun with Debug</code> and interactive debugging.</li>
</ul>
<p><img src="figs/debugRStudio1.png" alt="RStudio debugging 1" /> <img src="figs/debugRStudio2.png" alt="RStudio debugging 2" /></p>
<ul>
<li><p>StatET (Eclipse plugin)</p></li>
<li><p><a href="http://ess.r-project.org/Manual/ess.html#Developing-with-ESS">emacs ESS and tracebug</a></p></li>
</ul>
</div>
</div>
<div id="exercise-1" class="section level3 unnumbered">
<h3>Exercise</h3>
<ol style="list-style-type: decimal">
<li>Your turn - play with <code>traceback</code>, <code>recover</code> and <code>debug</code>:</li>
</ol>
<p>(Example originally by Martin Morgan and Robert Gentleman.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">e &lt;-<span class="st"> </span><span class="cf">function</span>(i) {
  x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>
  <span class="cf">if</span> (i <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>) x[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]
  <span class="cf">else</span> x[<span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="co"># oops! x[-(1:2)]</span>
}
f &lt;-<span class="st"> </span><span class="cf">function</span>() <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, e)
g &lt;-<span class="st"> </span><span class="cf">function</span>() <span class="kw">f</span>()</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Fix <code>readFasta2</code>.</li>
</ol>
<p>Preparing the ground</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## make sure you have the &#39;sequences&#39; package.
<span class="kw">library</span>(<span class="st">&quot;devtools&quot;</span>)
<span class="kw">install_github</span>(<span class="st">&quot;lgatto/sequences&quot;</span>) ## from github
## or 
<span class="kw">install.packages</span>(<span class="st">&quot;sequences&quot;</span>) ## from CRAN</code></pre></div>
<p>A working example: reading a single sequence from a fasta file to create a object of class <code>DnaSeq</code>, representing the DNA string:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;sequences&quot;</span>)</code></pre></div>
<pre><code>## Loading required package: Rcpp</code></pre>
<pre><code>## This is package &#39;sequences&#39;</code></pre>
<pre><code>## 
## Attaching package: &#39;sequences&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     id</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;sequences&quot;</span>),
         <span class="dt">full.names=</span><span class="ot">TRUE</span>, <span class="dt">pattern =</span> <span class="st">&quot;aDnaSeq.fasta&quot;</span>)
<span class="kw">readFasta</span>(f)</code></pre></div>
<pre><code>## Object of class DnaSeq 
##  Id: example dna sequence 
##  Length: 132 
##  Alphabet: A C G T 
##  Sequence: AGCATACGACGACTACGACACTACGACATCAGACACTACAGACTACTACGACTACAGACATCAGACACTACATATTTACATCATCAGAGATTATATTAACATCAGACATCGACACATCATCATCAGCATCAT</code></pre>
<p>A bug, trying to read multiple sequences from a fasta file. The expected behaviour would be to return a list of <code>DnaSeq</code> objects:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Get readFasta2, the function to debug
sequences<span class="op">:::</span><span class="kw">debugme</span>()
## Get an example file
f &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;sequences&quot;</span>),
         <span class="dt">full.names=</span><span class="ot">TRUE</span>, <span class="dt">pattern =</span> <span class="st">&quot;moreDnaSeqs.fasta&quot;</span>)
## BANG!
<span class="kw">readFasta2</span>(f)</code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="navigating-the-bioconductor-project.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="session-information.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
